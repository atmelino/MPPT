<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en">

<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <title>MPPT Version Version 3</title>
</head>

<body>



    New Version 2019

    <h2>Setup</h2>
    
    <h4>Raspberry Pi Installation</h4>
    On Ubuntu:<br>
    download Raspbian Stretch<br>
    install Raspbian on micro SD card using startup disk creator
    
    <h4>Raspberry Pi Configuration</h4>
    sudo raspi-config<br>
    enable I2C<br>
    enable serial port<br>
    disable serial port shell<br>
    enable built-in VNC Server (RealVNC)
    
    <h4>VNC Server</h4>
    in options, make sure authentication is set to VNC<br>
    https://raspberrypi.stackexchange.com/questions/68838/i-failed-to-remote-connect-to-raspberry-pi-3-from-ubuntu<br>
    On Ubuntu client side, using vinagre<br>
    headless VNC server<br>
    https://thisdavej.com/beginners-guide-to-installing-node-js-on-a-raspberry-pi/
    
    <h4>File Sharing</h4>
    <code>mkdir /home/user/sshfs_pi/<br></code><br>
    <code>sudo sshfs -o allow_other pi@192.168.0.100:/ /home/user/sshfs_pi/</code>
    
    <h4>Testing communication with Arduino</h4>
    <code>minicom -b 9600 -o -D /dev/ttyAMA0</code>
    
    Set fixed IP
    
    <h4>Install Node.js</h4>
    Zero requires different installation than biger RPi because it uses ARM 6 architecture<br>
    https://eddielee.me/running-node-js-on-a-raspberry-pi-zero/<br>
    Steps:<br>
    <code>wget https://nodejs.org/dist/latest/node-v11.6.0-linux-armv6l.tar.gz</code><br>
    <code>tar -xzf node-v11.6.0-linux-armv6l.tar.gz</code><br>
    <code>sudo cp -R node-v11.6.0-linux-armv6l/* /usr/local/</code><br>
    <code>nano ~/.profile</code><br>
    Add<br>
    PATH=$PATH:/usr/local/bin<br>
    at the end then press ctrl + x to exit. Type yes to save.<br>
    
    
    simple web server:<br>
    <code>sudo npm install http-server -g</code><br>
    http-server<br>
    https://www.npmjs.com/package/http-server<br>
    
    serial to web socket:<br>
    <code>npm install express</code><br>
    <code>npm install ws</code><br>
    <code>npm install serialport</code><br>
    <code>npm install ip</code><br>
    
    (-g, module not found?)
    
    <h4>Autostart node server on Pi startup</h4>
    add the MPPT software as a service using systemd.<br>
    add file MPPT.service to /etc/systemd/system.<br>
    Start and stop:<br>
    <code>sudo systemctl start MPPT.service</code><br>
    <code>sudo systemctl stop MPPT.service</code><br>
    check status:<br>
    <code>sudo systemctl status MPPT.service</code><br>
    during development</code><br>
    <code>sudo systemctl daemon-reload</code><br>
    <code>sudo systemctl restart MPPT.service</code><br>
    To start automatically at boot:<br>
    <code>sudo systemctl enable MPPT.service</code><br>
    To list all services:<br>
    <code>sudo systemctl list-unit-files</code><br>
    or<br>
    <code>sudo systemctl list-unit-files | grep MPPT.service </code><br>
    To see output from service:<br>
    <code>journalctl -u MPPT.service -b</code><br>
    To shorten journal file:<br>
    <code>sudo journalctl --rotate</code><br>
    <code>sudo journalctl --vacuum-time=1s</code><br>
    

<h2>Software</h2>

<h3>Operating System</h3>	
How to Setup Raspberry Pi Zero W for Headless    https://www.youtube.com/watch?v=LlCr09B2HZI
<a href="https://www.npmjs.com/package/raspi-pwm">https://www.npmjs.com/package/raspi-pwm</a><br>


<h3>Application Software</h3>	
npm install rpio<br>
npm install raspi<br>
npm install raspi-pwm<br>
<br>


<h3>PWM on Raspberry Pi</h3>

<a href="https://www.npmjs.com/package/raspi-pwm">https://www.npmjs.com/package/raspi-pwm</a><br>

<a href="https://github.com/nebrius/raspi-pwm">https://github.com/nebrius/raspi-pwm</a><br>

<a href="https://raspberrypi.stackexchange.com/questions/4906/control-hardware-pwm-frequency">https://raspberrypi.stackexchange.com/questions/4906/control-hardware-pwm-frequency</a><br>



<h3>Raspberry Pi Power Consumption</h3>

<a href="https://www.jeffgeerling.com/blogs/jeff-geerling/raspberry-pi-zero-conserve-energy">https://www.jeffgeerling.com/blogs/jeff-geerling/raspberry-pi-zero-conserve-energy</a>
<br>

<h3>Raspberry Pi Zero Pins</h3>

<img src="images/version3_0/rpizero_01.png" width="800"  alt="">
<br>
<a href="https://learn.sparkfun.com/tutorials/raspberry-gpio/all">https://learn.sparkfun.com/tutorials/raspberry-gpio/all</a><br>

<img src="images/version3_0/rpizero_02.jpg" width="800"  alt="">



<h3>Wifi</h3>
https://github.com/tlhunter/node-wireless

</body>
